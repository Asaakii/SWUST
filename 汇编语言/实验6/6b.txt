DSEG SEGMENT
TBEG DB 'MAY I COME IN?', 0DH, 0AH, 'COME IN PLEASE', 0DH, 0AH
	 DB 'GOOD MORNING, SIR. I AM A STUDENT.', 0DH, 0AH
	 DB 'I WANT TO GET A PART-WORK IN MY HOLIDAYS', 0DH, 0AH
	 DB 'I CAN WORK IN THE DAYTIME, AND I WILL', 0DH, 0AH
	 DB 'DO EVERYTHING YOU ASSIGN TO ME DO MAY BEST', 0DH, 0AH
	 DB 'OK. I WILL CONSIDER IT. WE WILL INFORM YOU OUR', 0DH, 0AH
	 DB 'ANSWER AS FAST AS POSSIBLE', 0DH, 0AH
	 DB 'THANK YOU. YOU ARE WELL KIND. SEE YOU LATE', 0DH, 0AH. '$'
ENDADR EQU $-1
	   DB 100 DUP (0)
TEND DW ENDADR

MEG1 DB 0DH, 0AH, 'THE TEXT IS', 0DH, 0AH, '$'
MEG2 DB 0DH, 0AH, 'DELETE, MOVE OR COPY? (D/M/C)', '$'
MEG3 DB 0DH, 0AH, 'OK, THIS ITEM WILL DELETE THE SUBSTRING FORM M TO N.'
	 DB 0DH, 0AH, 'PLEASE INPUT THE VALUE OF M AND N:', '$'
MEG4 DB 0DH, 0AH, 'OK, THIS ITEM WILL MOVE THE SUBSTRING FORM M TO N.'
	 DB 'TO THE PLACE OF L', 0DH, 0AH, 'PLEASE INPUT THE VALUE OF M, N AND L:', '$'
MEG5 DB 0DH, 0AH, 'OK, THIS ITEM WILL COPY THE SUBSTRING FORM M TO N.'
	 DB 'TO THE PLACE OF L', 0DH, 0AH, 'PLEASE INPUT THE VALUE OF M, N AND L:', '$'
MEG6 DB 0DH, 0AH, 'THE OPERATED TEXT IS', 0DH, 0AH, 0AH, '$'
MEG7 DB 0DH, 0AH, 'INPUT ERROR! PLEASE ERPEAT IS', '$'
DSEG ENDS

SSEG SEGMENT STACK
	STK DB 50 DUP(0)
SSEG ENDS

CSEG SEGMENT
	ASSUME CS:CSEG, SS:SSEG, DS:DSEG, ES:DSEG
START:
	MOV AX, DSEG
	MOV DS, AX
	MOV ES, AX
	MOV AX, SSEG
	MOV SS, AX
	MOV SP, SIZE STK
	LEA DX, MEG1
	MOV AH, 09H
	INT 21H
	MOV AH, 09H
	LEA DX, TBEG
	INT 21H
	LEA DX, MEG2
	MOV AH, 09H
	INT 21H
	MOV AH, 01H
	INT 21H
	CMP AL, 'D'
	JZ DELET
	CMP AL, 'M'
	JZ MOVEE
	CMP AL, 'm'
	JZ COPYY
	CMP AL, 'C'
	JNZ OVER
COPYY:
	LEA DX, MEG5
	MOV AH, 09H
	INT 21H
	CALL ACCMNL
	CALL COPYP
	JMP ENDOP
DELET:
	LEA DX, MEG3
	MOV AH, 09H
	INT 21H
	CALL ACCMN
	CALL DELEP
	JMP ENDOP
MOVEE:
	LEA DX, MEG4
	MOV AH, 09H
	INT 21H
	CALL ACCMNL
	CALL COPYP
	CALL DELEP
ENDOP:
	LEA DX, MEG6
	MOV AH, 09H
	INT 21H
	LEA DX, TBEG
	MOV AH, 09H
	INT 21H
OVER:
	MOV AH, 4CH
	INT 21H

ACCMNL PROC
	CALL ACCEPT
	MOV BX, DX
	CALL ACCEPT
	MOV AX, DX
	CALL ACCEPT
	CMP BX, AX
	JB C1
	XCHG BX, AX
C1:
	JMP DX, BX
	JA C2
	CLC
	RET
C2:
	CMP DX, AX
	JNA ERR
	STC
	RET
ERR:
	LEA DX, MEG7
	MOV AH, 09H
	INT 21H
	JMP ACCMNL
ACCMNL ENDP

ACCMN PROC
	PUSH DX
	CALL ACCEPT
	MOV BX, DX
	CALL ACCEPT
	MOV AX, DX
	CMP BX, AX
	JB C11
	XCHG BX, AX
C11:
	POP CX
RET
ACCMN ENDP

ACCEPT PROC
	PUSH AX
	PUSH BX
	XOR DX, DX
ACC1:
	MOV AH, 01H
	INT 21H
	CMP AL, '0'
	JB RETUN
	CMP AL, '9'
	JA RETUN
	SUB AL, 30H
	MOV BX, DX
	SHL DX, 1
	SHL DX, 1
	ADD DX, BX
	SHL DX, 1
	XOR AH, AH
	ADD DX, AX
	JMP ACC1
RETUN:
	POP BX
	POP AX
RET
ACCEPT ENDP

COPYP PROC
	PUSH CX
	PUSH DX
	PUSH SI
	PUSH DI
	PUSH BP
	PUSHF
	MOV CX, AX
	SUB CX, BX
	INC CX
	MOV DI, SI
	ADD DI, CX
	PUSH CX
	MOV CX, TEND
	SUB CX, DX
	INC CX
	STD
	REP MOVSB
	POP CX
	ADD TEND, CX
	POPF
	JC COPY1
	ADD AX, CX
	ADD BX, CX
COPY1:
	LEA SI, TBEG
	ADD SI, BX
	LEA DI, TBEG
	ADD DI, DX
	CLD
	REP MOVSB
	POP BP
	POP DI
	POP SI
	POP DX
	POP CX
	RET
COPYP ENDP

DELEP PROC
	PUSH CX
	PUSH DX
	PUSH SI
	PUSH DI
	MOV DX, AX
	SUB DX, BX
	INC DX
	MOV CX, TEND
	SUB CX, OFFSET TBEG
	INC CX
	SUB CX, DX
	MOV CX, DX
	MOV DI, BX
	MOV SI, AX
	INC SI
	CLD
	REP MOVSB
	SUB TEND, DX
	POP DI
	POP SI
	POP DX
	POP CX
	RET
DELEP ENDP
CSEG ENDS

END START