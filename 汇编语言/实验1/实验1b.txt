; 从键盘上接收两个两位位十六进制数，求其乘积，并将结果在屏幕上显示出来

DATA SEGMENT
	BUF DB 0, 0
DATA ENDS

STACK SEGMENT PARA STACK 'STACK'
	BUF_1 DW 20H DUP (0)
	LEN EQU $-BUF_1
STACK ENDS

CODE SEGMENT
	ASSUME CS:CODE,DS:DATA,SS:STACK
START:
	MOV AX, DATA
	MOV DS, AX
	MOV AX, STACK
	MOV SS, AX
	MOV SP, OFFSET BUF

	MOV SI, OFFSET BUF
	MOV CX, 2
INPUT:
	CALL INPUT_2_HEX
	MOV [SI], DL
	INC SI
	CALL PRINT_BLACK
	LOOP INPUT

	MOV BX, DS:[0]
	MOV AX, DS:[1]
	MUL BX

	CALL PRINT_ENTER
PRINT:
	MOV AL, DS:[0]
	MUL BYTE PTR DS:[1]
	MOV DL, AH
	CALL PRINT_2_HEX
	MOV DL, AL
	CALL PRINT_2_HEX

	MOV AH, 4CH
	INT 21H

INPUT_1_HEX:
	PUSHF
	PUSH BX
	MOV BH, AH
	MOV AH, 01H
	INT 21H
	CMP AL, 'A'
	JB I1
	SUB AL, 37H
	JMP SHORT RETURN
I1:
	SUB AL, 30H
RETURN:
	MOV AH, BH
	POP BX
	POPF
RET

INPUT_2_HEX:
	PUSH AX
	PUSHF
	CALL INPUT_1_HEX
	MOV DL, AL
	MOV AL, 10H
	MUL DL
	MOV DL, AL
	CALL INPUT_1_HEX
	ADD DL, AL
	POPF
	POP AX
RET

PRINT_1_HEX:
	PUSH AX
	PUSH DX
	PUSHF
	CMP DL, 0AH
	JB P1
	ADD DL, 7H
P1:
	ADD DL, 30H
	MOV AH, 02H
	INT 21H
	POPF
	POP DX
	POP AX
RET

PRINT_2_HEX:
	PUSH AX
	PUSH DX
	PUSHF
	MOV AL, DL
	MOV AH, 0
	MOV DL, 10H
	DIV DL
	MOV DL, AL
	CALL PRINT_1_HEX
	MOV DL, AH
	CALL PRINT_1_HEX
	POPF
	POP DX
	POP AX
RET

PRINT_BLACK:
	PUSH AX
	PUSH DX
	MOV DL, ' '
	MOV AH, 02H
	INT 21H
	POP DX
	POP AX
RET

PRINT_ENTER:
	PUSH AX
	PUSH DX
	MOV  DL, 0DH
	MOV  AH, 02H
	INT  21H
	MOV  DL, 0AH
	MOV  AH, 02H
	INT  21H
	POP  DX
	POP  AX
RET
CODE ENDS

END START